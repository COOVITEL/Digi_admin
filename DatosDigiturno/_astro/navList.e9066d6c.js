import{j as e}from"./jsx-runtime.a2dc3690.js";import{T as d}from"./dates.9bba945f.js";import{C as A,a as _,P as D,A as E,L as O,B as k,p as Y,b as B,c as z,d as $,e as J,f as H,g as I}from"./index.f8b4ff70.js";import{o as q}from"./options.f2ef4408.js";import{r as p}from"./index.72123234.js";A.register(_,D,E,O,k,Y,B,z);function K({name:l,time:r}){const t=["Caja","Crédito","Afiliación","Ahorro","Seguros","Auxilios","Estado","Otros"],[o,s]=p.useState(t.reduce((m,f)=>(m[f]=d.filter(b=>b.type2===f).length,m),{})),[i,a]=p.useState(t.map(m=>(o[m]/d.length*100).toFixed(2))),[x,j]=p.useState("Todas las Sucursales");p.useEffect(()=>{const m=new Date;let f=m.getFullYear(),b=r===0?m.getMonth()+1:m.getMonth(),c;b==0?(f=m.getFullYear()-1,c=d.filter(u=>Number(u.date.split("-")[1])===12&&Number(u.date.split("-")[0])===f)):c=d.filter(u=>Number(u.date.split("-")[1])===b&&Number(u.date.split("-")[0])===f),r==2&&(b=m.getMonth()-1,b<0?c=d.filter(u=>Number(u.date.split("-")[1])>=12+b):c=d.filter(u=>Number(u.date.split("-")[1])>=b)),l=="all"&&j("Todas las Sucursales"),l!="all"&&(c=c.filter(u=>u.city===l),j(l));const h=t.reduce((u,T)=>(u[T]=c.filter(M=>M.type2===T).length,u),{});s(Object.values(h));const N=Object.values(h).reduce((u,T)=>u+T,0),S=t.map(u=>(h[u]/N*100).toFixed(2));a(S)},[l,r]);const w={labels:t,datasets:[{data:o,backgroundColor:["rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)","rgba(72, 209, 0, 0.5)","rgba(220, 19, 0, 0.5)","rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)"],borderColor:["rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)","rgba(72, 209, 0)","rgba(220, 19, 0)","rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)"],borderWidth:2}]};return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-28 rounded-lg w-[65%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Tipos de Turnos Tomados en ",x]}),e.jsx($,{data:w,options:q}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center",children:"Tipo Turno"}),t.map((m,f)=>e.jsx("th",{className:"p-2 text-center",children:m},f))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center",children:"Procentaje"}),i.map((m,f)=>e.jsxs("td",{className:"text-center",children:[m,"%"]},f))]})]})]})}A.register(_,D,E,O,k,Y,B,z);function Q({name:l,time:r}){const t=["Sin calificar","Calificado en Sucursal","Calificado por SMS","Calificado por llamada","No contactado"],[o,s]=p.useState(),[i,a]=p.useState(d);function x(n,y,L){const F=new Date;let R=F.getFullYear(),v=L===0?F.getMonth()+1:F.getMonth(),C=n.filter(g=>Number(g.date.split("-")[1])===v);v==0?(R=F.getFullYear()-1,C=n.filter(g=>Number(g.date.split("-")[1])===12&&Number(g.date.split("-")[0])===R)):C=n.filter(g=>Number(g.date.split("-")[1])===v&&Number(g.date.split("-")[0])===R),L===2&&(v=F.getMonth()-1,v<0?C=n.filter(g=>Number(g.date.split("-")[1])>=12+v):C=n.filter(g=>Number(g.date.split("-")[1])>=v)),y=="all"&&(a(C),s("Todas las Sucursales")),y!="all"&&(a(C.filter(g=>g.city===y)),s(y))}p.useEffect(()=>{x(d,l,r)},[l,r]);const j=i.filter(n=>n.score_time==="empty").length,w=i.filter(n=>n.score_time!="empty"&&n.state==="finished"&&n.sms_send!="send").length,m=i.filter(n=>n.score_time!="empty"&&n.state==="finished"&&n.sms_send==="send").length,f=i.filter(n=>n.score_time!="empty"&&n.state==="by_call").length,b=i.filter(n=>n.state=="not_contacted").length,c=(j/i.length*100).toFixed(2),h=(w/i.length*100).toFixed(2),N=(m/i.length*100).toFixed(2),S=(f/i.length*100).toFixed(2),u=(b/i.length*100).toFixed(2),T={labels:t,datasets:[{data:[j,w,m,f,b],backgroundColor:["rgba(230, 151, 227, 0.9)","rgba(230, 138, 82, 0.9)","rgba(242, 252, 97, 0.9)","rgba(146, 122, 197, 0.9)","rgba(116, 172, 197, 0.9)"]}]},M={plugins:{legend:{display:!1}}};return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-20 rounded-lg w-[60%] h-auto",children:[e.jsxs("h5",{className:"text-white pb-3 text-sm",children:["Estados de Calificación de Turno en ",o]}),e.jsx("div",{className:"w-[250px]",children:e.jsx(J,{data:T,options:M})}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center text-sm",children:"Estado de Turno"}),t.map((n,y)=>e.jsx("th",{className:"p-2 text-center text-sm",children:n},y))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center text-sm",children:"Procentaje"}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[c," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[h," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[N," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[S," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[u," %"]})]})]})]})}A.register(_,D,E,O,k,Y,B,z);function P({name:l,time:r,typeScore:t,list:o,param:s}){const i=o,[a,x]=p.useState(i.reduce((c,h)=>(c[h]=d.filter(N=>N[s]===h).length,c),{})),[j,w]=p.useState(i.map(c=>(a[c]/d.length*100).toFixed(2))),[m,f]=p.useState("Todas las Sucursales");p.useEffect(()=>{const c=new Date;let h=c.getFullYear(),N=r===0?c.getMonth()+1:c.getMonth(),S;N==0?(h=c.getFullYear()-1,S=d.filter(n=>Number(n.date.split("-")[1])===12&&Number(n.date.split("-")[0])===h)):S=d.filter(n=>Number(n.date.split("-")[1])===N&&Number(n.date.split("-")[0])===h),r==2&&(N=c.getMonth()-1,N<0?S=d.filter(n=>Number(n.date.split("-")[1])>=12+N):S=d.filter(n=>Number(n.date.split("-")[1])>=N)),l=="all"&&f("Todas las Sucursales"),l!="all"&&(S=S.filter(n=>n.city===l),f(l));const u=i.reduce((n,y)=>(n[y]=S.filter(L=>L[s]===y).length,n),{});x(Object.values(u));const T=Object.values(u).reduce((n,y)=>n+y,0),M=i.map(n=>(u[n]/T*100).toFixed(2));w(M)},[l,r]);const b={labels:i,datasets:[{data:a,backgroundColor:["rgb(52, 104, 192)","rgb(134, 167, 252)","rgb(170, 217, 187)","rgb(250, 239, 155)","rgba(220, 19, 0, 0.5)"],borderWidth:2}]};return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[43%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Calificación ",t,", ",m]}),e.jsx($,{data:b,options:q}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsx("tr",{children:i.map((c,h)=>e.jsx("th",{className:"p-2 text-center",children:c},h))}),e.jsx("tr",{children:j.map((c,h)=>e.jsxs("td",{className:"p-2 text-center",children:[c,"%"]},h))})]})]})}function V({name:l,time:r}){return e.jsxs("div",{className:"flex flex-col w-full items-center pt-5",children:[e.jsx("h2",{className:"text-white text-2xl",children:"Calificaciones dadas por nuestros asosiados"}),e.jsxs("div",{className:"flex flex-wrap gap-10 m-5 justify-center items-center",children:[e.jsx(P,{name:l,time:r,typeScore:"Servicio",list:["Excelente","Bueno","Normal","Regular","Malo"],param:"score_service"}),e.jsx(P,{name:l,time:r,typeScore:"Tiempo",list:["Muy rápido","Rápido","Normal","Lento","Muy Lento"],param:"score_time"}),e.jsx(P,{name:l,time:r,typeScore:"Solicitud Atendida",list:["Si","No"],param:"score_att"}),e.jsx(P,{name:l,time:r,typeScore:"Recomendación",list:["Si","Tal vez","No"],param:"score_recommen"})]})]})}A.register(_,H,D,E,O,k,Y,B,z);function X(l,r){const t=new Date;let o=t.getFullYear(),s=r===0?t.getMonth()+1:t.getMonth(),i=d.filter(a=>Number(a.date.split("-")[1])===s);return s==0?(o=t.getFullYear()-1,i=d.filter(a=>Number(a.date.split("-")[1])===12&&Number(a.date.split("-")[0])===o)):i=d.filter(a=>Number(a.date.split("-")[1])===s&&Number(a.date.split("-")[0])===o),r==2&&(s=t.getMonth()-1,s<0?i=d.filter(a=>Number(a.date.split("-")[1])>=12+s):i=d.filter(a=>Number(a.date.split("-")[1])>=s)),l==="all"?i:i.filter(a=>a.city===l)}function U(l,r,t){return l.reduce((o,s)=>{if(s[r]&&s[t]){let i=s[r].substring(0,10),a=s[t].substring(0,10);if(s.date==i&&s.date==a){let x=new Date(s[r]),w=(new Date(s[t]).getTime()-x.getTime())/6e4;o[s.date]?o[s.date]=(o[s.date]+w)/2:o[s.date]=w}}return o},{})}function W(l){return Object.values(l).reduce((r,t)=>r+t,0)/Object.values(l).length}function Z(l,r,t){return{labels:l,datasets:[{data:r,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(185, 182, 25)",tension:.3},{data:t,borderColor:"rgb(238, 80, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3}]}}function ee({name:l,time:r}){const[t,o]=p.useState(d),[s,i]=p.useState();p.useEffect(()=>{const h=X(l,r);o(h),i(l==="all"?"Todas las Sucursales":l)},[l,r]);const a=U(t,"arrival_time","await_time"),x=U(t,"await_time","atention_time"),j=W(a),w=W(x),m=Object.keys(a),f=Object.values(a),b=Object.values(x),c=Z(m,f,b);return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[67%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Tiempo de Espera en ",s]}),e.jsx(I,{data:c,options:q}),e.jsxs("div",{className:"flex flex-row gap-16 pt-4",children:[e.jsxs("h3",{className:"text-[rgb(22,234,234)]",children:["Espera promedio:  ",j.toFixed(2)," Min"]}),e.jsxs("h3",{className:"text-[rgba(248,106,213)]",children:["Atencion promedio:  ",w.toFixed(2)," Min"]})]})]})}function te({name:l,time:r}){return e.jsxs("div",{className:"flex flex-col w-full items-center pt-5",children:[e.jsx("h2",{className:"text-white text-2xl",children:"Tiempos de Atención a nuestros Asociados"}),e.jsx("div",{className:"flex flex-wrap gap-10 m-5 justify-center items-center w-full h-auto",children:e.jsx(ee,{name:l,time:r})})]})}A.register(_,H,D,E,O,k,Y,B,z);function G(l){return l.reduce((r,t)=>(r[t.date]?r[t.date]++:r[t.date]=1,r),{})}function se(l,r){const t=new Date;let o=t.getFullYear(),s=r===0?t.getMonth()+1:t.getMonth(),i;return s==0?(o=t.getFullYear()-1,i=d.filter(a=>Number(a.date.split("-")[1])===12&&Number(a.date.split("-")[0])===o)):i=d.filter(a=>Number(a.date.split("-")[1])===s&&Number(a.date.split("-")[0])===o),r===2&&(s=t.getMonth()-1,s<0?i=d.filter(a=>Number(a.date.split("-")[1])>=12+s&&Number(a.date.split("-")[0])===o):i=d.filter(a=>Number(a.date.split("-")[1])>=s&&Number(a.date.split("-")[0])===o)),l==="all"?i:i.filter(a=>a.city===l)}function ae({name:l,time:r}){const[t,o]=p.useState(G(d));p.useEffect(()=>{const x=se(l,r);o(G(x))},[l,r]);const s=Object.keys(t),i=Object.values(t),a={labels:s,datasets:[{label:"Turnos en el Tiempo",data:i,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3}]};return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[70%] h-auto",children:[e.jsx("h4",{className:"text-white",children:"Cantidad de Turnos Tomados por Fecha"}),e.jsx(I,{data:a,options:q})]})}function ce(){const l=d.map(x=>x.city),r=[...new Set(l)],[t,o]=p.useState("all"),[s,i]=p.useState(0);function a(x,j){o(x),i(j)}return e.jsxs("div",{className:"flex flex-col gap-10 justify-center items-center",children:[e.jsxs("nav",{className:"flex flex-col p-3 px-10 mt-5 fixed top-0 bg-zinc-700 rounded-lg items-center",children:[e.jsxs("ul",{className:"flex flex-row gap-10",children:[e.jsx("button",{className:t==="all"?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>a("all",s),children:"Global"},"todos"),r.map(x=>e.jsx("button",{className:t===x?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>a(x,s),children:x},x))]}),e.jsxs("ul",{className:"flex flex-row gap-10 text-zinc-400",children:[e.jsx("button",{className:s===0?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>a(t,0),children:"Mes Actual"}),e.jsx("button",{className:s===1?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>a(t,1),children:"Ultimo mes"}),e.jsx("button",{className:s===2?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>a(t,2),children:"Ultimos 3 meses"})]})]}),e.jsx(K,{name:t,time:s}),e.jsx(ae,{name:t,time:s}),e.jsx(Q,{name:t,time:s}),e.jsx(V,{name:t,time:s}),e.jsx(te,{name:t,time:s})]})}export{ce as default};
