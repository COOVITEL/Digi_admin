import{j as e,g as E}from"./turns.4589a0ea.js";import{C as A,a as F,P as D,A as _,L as O,B as k,p as L,b as q,c as B,d as H,e as Q,f as J,g as K}from"./index.f8b4ff70.js";import{o as P}from"./options.f2ef4408.js";import{r as d}from"./index.72123234.js";import{T as W}from"./dates.27327105.js";A.register(F,D,_,O,k,L,q,B);function V({name:s,time:r}){d.useEffect(()=>{async function l(){const x=await E();o(x.data)}l()},[]);const i=["Caja","Crédito","Afiliación","Ahorro","Seguros","Auxilios","Estado","Otros","Obsequio"],[c,o]=d.useState([]),[a,u]=d.useState([]);d.useEffect(()=>{const l=T(s,r,c);u(l)},[s,r,c]);const t=i.reduce((l,x)=>(l[x]=a.filter(N=>N.type2===x).length,l),{}),j=Object.values(t).reduce((l,x)=>l+x,0),f=i.map(l=>(t[l]/j*100).toFixed(2)),v={labels:i,datasets:[{data:t,backgroundColor:["rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)","rgba(72, 209, 0, 0.5)","rgba(220, 19, 0, 0.5)","rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)"],borderColor:["rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)","rgba(72, 209, 0)","rgba(220, 19, 0)","rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)"],borderWidth:2}]};function T(l,x,N){const m=new Date;let p=m.getFullYear(),h=x===0?m.getMonth()+1:m.getMonth(),g;return h==0?(p=m.getFullYear()-1,g=N.filter(b=>Number(b.date.split("-")[1])===12&&Number(b.date.split("-")[0])===p)):g=N.filter(b=>Number(b.date.split("-")[1])===h&&Number(b.date.split("-")[0])===p),x===2&&(h=m.getMonth()-1,h<0?g=N.filter(b=>Number(b.date.split("-")[1])>=12+h&&Number(b.date.split("-")[0])===p):g=N.filter(b=>Number(b.date.split("-")[1])>=h&&Number(b.date.split("-")[0])===p)),l==="all"?g:g.filter(b=>b.city===l)}return e.jsxs("div",{className:"flex flex-row w-[95%] p-10 pb-20 gap-5 items-center",children:[e.jsx("p",{className:"text-white w-52 text-center",children:"Tipos de turnos tomados por nuestros asociados, en cada una de las sucursales. Durante el mes actual, el mes pasado o durante los 3 ultimos meses."}),e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-5 rounded-lg",children:[e.jsx(H,{data:v,options:P}),e.jsx("table",{className:"text-white mt-8",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center",children:"Tipo Turno"}),i.map((l,x)=>e.jsx("th",{className:"p-2 text-center",children:l},x))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center",children:"Procentaje"}),f.map((l,x)=>e.jsxs("td",{className:"text-center",children:[l,"%"]},x))]})]})})]})]})}A.register(F,D,_,O,k,L,q,B);function X({name:s,time:r}){const i=["Sin calificar","Calificado en Sucursal","Calificado por SMS","Calificado por llamada","No contactado"],[c,o]=d.useState(),[a,u]=d.useState([]),[t,j]=d.useState([]);d.useEffect(()=>{async function n(){const w=await E();j(w.data)}n()},[]),d.useEffect(()=>{f(t,s,r)},[s,r,t]);function f(n,w,Y){const M=new Date;let U=M.getFullYear(),S=Y===0?M.getMonth()+1:M.getMonth(),C=n.filter(y=>Number(y.date.split("-")[1])===S);S==0?(U=M.getFullYear()-1,C=n.filter(y=>Number(y.date.split("-")[1])===12&&Number(y.date.split("-")[0])===U)):C=n.filter(y=>Number(y.date.split("-")[1])===S&&Number(y.date.split("-")[0])===U),Y===2&&(S=M.getMonth()-1,S<0?C=n.filter(y=>Number(y.date.split("-")[1])>=12+S):C=n.filter(y=>Number(y.date.split("-")[1])>=S)),w=="all"&&(u(C),o("Todas las Sucursales")),w!="all"&&(u(C.filter(y=>y.city===w)),o(w))}const v=a.filter(n=>n.score_time==="empty").length,T=a.filter(n=>n.score_time!="empty"&&n.state==="finished"&&n.sms_send!="send").length,l=a.filter(n=>n.score_time!="empty"&&n.state==="finished"&&n.sms_send==="send").length,x=a.filter(n=>n.score_time!="empty"&&n.state==="by_call").length,N=a.filter(n=>n.state=="not_contacted").length,m=(v/a.length*100).toFixed(2),p=(T/a.length*100).toFixed(2),h=(l/a.length*100).toFixed(2),g=(x/a.length*100).toFixed(2),b=(N/a.length*100).toFixed(2),R={labels:i,datasets:[{data:[v,T,l,x,N],backgroundColor:["rgba(230, 151, 227, 0.9)","rgba(230, 138, 82, 0.9)","rgba(242, 252, 97, 0.9)","rgba(146, 122, 197, 0.9)","rgba(116, 172, 197, 0.9)"]}]},G={plugins:{legend:{display:!0,labels:{color:"white"}}}};return e.jsxs("div",{className:"flex flex-row w-[90%] p-10 gap-5 items-center",children:[e.jsx("p",{className:"text-white w-52 text-center",children:"Conocer los canales de calificacion de nuestro servicio usados por nuestros asociados es de gran importancia. Es por esto que en esta tabla podras encontrar los diferentes pocentajes y cantidad de turnos calificados por nuestros asociados."}),e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-20 rounded-lg w-[70%]",children:[e.jsxs("h5",{className:"text-white pb-3 text-sm",children:["Estados de Calificación de Turno en ",c]}),e.jsx("div",{className:"w-[380px]",children:e.jsx(Q,{data:R,options:G})}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center text-sm",children:"Estado de Turno"}),i.map((n,w)=>e.jsx("th",{className:"p-2 text-center text-sm",children:n},w))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center text-sm",children:"Procentaje"}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[m," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[p," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[h," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[g," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[b," %"]})]})]})]})]})}A.register(F,D,_,O,k,L,q,B);function z({name:s,time:r,typeScore:i,list:c,param:o}){const a=c,[u,t]=d.useState(a.reduce((m,p)=>(m[p]=W.filter(h=>h[o]===p).length,m),{})),[j,f]=d.useState(a.map(m=>(u[m]/W.length*100).toFixed(2))),[v,T]=d.useState("Todas las Sucursales"),[l,x]=d.useState([]);d.useEffect(()=>{async function m(){const p=await E();x(p.data)}m()},[]),d.useEffect(()=>{const m=new Date;let p=m.getFullYear(),h=r===0?m.getMonth()+1:m.getMonth(),g;h==0?(p=m.getFullYear()-1,g=l.filter(n=>Number(n.date.split("-")[1])===12&&Number(n.date.split("-")[0])===p)):g=l.filter(n=>Number(n.date.split("-")[1])===h&&Number(n.date.split("-")[0])===p),r==2&&(h=m.getMonth()-1,h<0?g=l.filter(n=>Number(n.date.split("-")[1])>=12+h):g=l.filter(n=>Number(n.date.split("-")[1])>=h)),s=="all"&&T("Todas las Sucursales"),s!="all"&&(g=g.filter(n=>n.city===s),T(s));const b=a.reduce((n,w)=>(n[w]=g.filter(Y=>Y[o]===w).length,n),{});t(Object.values(b));const R=Object.values(b).reduce((n,w)=>n+w,0),G=a.map(n=>(b[n]/R*100).toFixed(2));f(G)},[s,r,l]);const N={labels:a,datasets:[{data:u,backgroundColor:["rgb(52, 104, 192)","rgb(134, 167, 252)","rgb(170, 217, 187)","rgb(250, 239, 155)","rgba(220, 19, 0, 0.5)"],borderWidth:2}]};return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[43%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Calificación ",i,", ",v]}),e.jsx(H,{data:N,options:P}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsx("tr",{children:a.map((m,p)=>e.jsx("th",{className:"p-2 text-center",children:m},p))}),e.jsx("tr",{children:j.map((m,p)=>e.jsxs("td",{className:"p-2 text-center",children:[m,"%"]},p))})]})]})}function Z({name:s,time:r}){return e.jsxs("div",{className:"flex flex-col w-full items-center pt-5 pb-10",children:[e.jsx("h2",{className:"text-white text-2xl",children:"Calificaciones dadas por nuestros asosiados"}),e.jsx("p",{className:"text-white p-5 w-[800px] text-center",children:"Conocer el servicio brindado de nuestros asesores es de gran importancia. Pero conocer la percepcion de nuestros asociados es aun mas importante."}),e.jsx("p",{className:"text-white p-5 w-[1000px] text-center",children:"Eso por esto que acontinuación podras encontrar la percepción del servicio, atencion, tiempo de sus visitas y si nuestros asociados nos recomendarian con un amigo o conocido."}),e.jsxs("div",{className:"flex flex-wrap gap-10 m-5 justify-center items-center",children:[e.jsx(z,{name:s,time:r,typeScore:"Servicio",list:["Excelente","Bueno","Normal","Regular","Malo"],param:"score_service"}),e.jsx(z,{name:s,time:r,typeScore:"Tiempo",list:["Muy rápido","Rápido","Normal","Lento","Muy Lento"],param:"score_time"}),e.jsx(z,{name:s,time:r,typeScore:"Solicitud Atendida",list:["Si","No"],param:"score_att"}),e.jsx(z,{name:s,time:r,typeScore:"Recomendación",list:["Si","Tal vez","No"],param:"score_recommen"})]})]})}A.register(F,J,D,_,O,k,L,q,B);function ee(s,r,i){const c=new Date;let o=c.getFullYear(),a=r===0?c.getMonth()+1:c.getMonth(),u=i.filter(t=>Number(t.date.split("-")[1])===a);return a==0?(o=c.getFullYear()-1,u=i.filter(t=>Number(t.date.split("-")[1])===12&&Number(t.date.split("-")[0])===o)):u=i.filter(t=>Number(t.date.split("-")[1])===a&&Number(t.date.split("-")[0])===o),r==2&&(a=c.getMonth()-1,a<0?u=i.filter(t=>Number(t.date.split("-")[1])>=12+a):u=i.filter(t=>Number(t.date.split("-")[1])>=a)),s==="all"?u:u.filter(t=>t.city===s)}function I(s,r,i){return s.reduce((c,o)=>{if(o[r]&&o[i]){let a=o[r].substring(0,10),u=o[i].substring(0,10);if(o.date==a&&o.date==u){let t=new Date(o[r]),f=(new Date(o[i]).getTime()-t.getTime())/6e4;c[o.date]?c[o.date]=(c[o.date]+f)/2:c[o.date]=f}}return c},{})}function $(s){return Object.values(s).reduce((r,i)=>r+i,0)/Object.values(s).length}function te(s,r,i){return{labels:s,datasets:[{data:r,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(185, 182, 25)",tension:.3},{data:i,borderColor:"rgb(238, 80, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3}]}}function se({name:s,time:r}){const[i,c]=d.useState([]),[o,a]=d.useState([]),[u,t]=d.useState();d.useEffect(()=>{async function p(){const h=await E();c(h.data)}p()},[]),d.useEffect(()=>{const p=ee(s,r,i);a(p),t(s==="all"?"Todas las Sucursales":s)},[s,r,i]);const j=I(o,"arrival_time","await_time"),f=I(o,"await_time","atention_time"),v=$(j),T=$(f),l=Object.keys(j),x=Object.values(j),N=Object.values(f),m=te(l,x,N);return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[80%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Tiempo de Espera en ",u]}),e.jsx(K,{data:m,options:P}),e.jsxs("div",{className:"flex flex-row gap-16 pt-4",children:[e.jsxs("h3",{className:"text-[rgb(22,234,234)]",children:["Espera promedio:  ",v.toFixed(2)," Min"]}),e.jsxs("h3",{className:"text-[rgba(248,106,213)]",children:["Atencion promedio:  ",T.toFixed(2)," Min"]})]})]})}function ae({name:s,time:r}){return e.jsxs("div",{className:"flex flex-col items-center w-full p-10",children:[e.jsx("h2",{className:"text-white text-2xl p-5",children:"Tiempos de Atención a nuestros Asociados"}),e.jsxs("div",{className:"flex flex-row w-[100%] items-center justify-center",children:[e.jsx("p",{className:"text-white w-[300px] text-center",children:"Los tiempos de espera y atención de nuestros asociados son de gran importancia para nosotros. Es por esto que conocer los tiempos promedios de antencion a nivel general y por sucursales, nos permitiran mejorar y organizar mejor nuestro servicio."}),e.jsx("div",{className:"flex flex-col w-full items-center pt-5",children:e.jsx(se,{name:s,time:r})})]})]})}A.register(F,J,D,_,O,k,L,q,B);function re({name:s,time:r}){const[i,c]=d.useState([]),[o,a]=d.useState([]);d.useEffect(()=>{async function f(){const v=await E();c(v.data)}f()},[]),d.useEffect(()=>{const f=le(s,r,i);a(ne(f))},[s,r,i]);const u=Object.keys(o),t=Object.values(o),j={labels:u,datasets:[{label:"Turnos en el Tiempo",data:t,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3}]};return e.jsxs("div",{className:"flex flex-row w-[95%] p-10 gap-5 items-center",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[95%]",children:[e.jsx("h4",{className:"text-white",children:"Cantidad de Turnos Tomados por Fecha"}),e.jsx(K,{data:j,options:P})]}),e.jsx("p",{className:"text-white w-52 text-center",children:"En esta grafica podras encontrar el numero de turnos tomados por dia a nivel general o en cada una de las sucursales. En la cual se podra determinar que dias y que fechas del mes presentamos mayor cantidad de visitas de nuestros asociados."})]})}function ne(s){return s.reduce((r,i)=>(r[i.date]?r[i.date]++:r[i.date]=1,r),{})}function le(s,r,i){const c=new Date;let o=c.getFullYear(),a=r===0?c.getMonth()+1:c.getMonth(),u;return a==0?(o=c.getFullYear()-1,u=i.filter(t=>Number(t.date.split("-")[1])===12&&Number(t.date.split("-")[0])===o)):u=i.filter(t=>Number(t.date.split("-")[1])===a&&Number(t.date.split("-")[0])===o),r===2&&(a=c.getMonth()-1,a<0?u=i.filter(t=>Number(t.date.split("-")[1])>=12+a&&Number(t.date.split("-")[0])===o):u=i.filter(t=>Number(t.date.split("-")[1])>=a&&Number(t.date.split("-")[0])===o)),s==="all"?u:u.filter(t=>t.city===s)}function xe(){const s=d.useRef(null),[r,i]=d.useState([]),c=r.map(l=>l.city),o=[...new Set(c)],[a,u]=d.useState("all"),[t,j]=d.useState(0);d.useEffect(()=>{async function l(){const x=await E();i(x.data)}l()},[o]),d.useEffect(()=>{let l;const x=()=>{clearTimeout(l),s.current&&(s.current.style.opacity=1),l=setTimeout(()=>{s.current&&(s.current.style.opacity=0)},500)};return window.addEventListener("scroll",x,{capture:!0}),()=>{window.removeEventListener("scroll",x,{capture:!0})}},[]);function f(l,x){u(l),j(x)}function v(){s.current&&(s.current.style.opacity=1)}function T(){s.current&&(s.current.style.opacity=0)}return e.jsxs("div",{className:"flex flex-col gap-50 justify-center items-center",children:[e.jsxs("nav",{ref:s,onMouseEnter:v,onMouseLeave:T,className:"flex flex-col p-3 px-10 mt-5 fixed top-0 bg-zinc-700 rounded-lg items-center transition duration-500 opacity-0",children:[e.jsxs("ul",{className:"flex flex-row gap-10",children:[e.jsx("button",{className:a==="all"?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>f("all",t),children:"Global"},"todos"),o.map(l=>e.jsx("button",{className:a===l?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>f(l,t),children:l},l))]}),e.jsxs("ul",{className:"flex flex-row gap-10 text-zinc-400",children:[e.jsx("button",{className:t===0?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>f(a,0),children:"Mes Actual"}),e.jsx("button",{className:t===1?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>f(a,1),children:"Ultimo mes"}),e.jsx("button",{className:t===2?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>f(a,2),children:"Ultimos 3 meses"})]})]}),e.jsx("h1",{className:"text-white text-3xl mt-5 mb-5 border-b-[3px] p-5",children:"Graficos y Estadisticas Sucursales"}),e.jsx(V,{name:a,time:t}),e.jsx(re,{name:a,time:t}),e.jsx(X,{name:a,time:t}),e.jsx(Z,{name:a,time:t}),e.jsx(ae,{name:a,time:t})]})}export{xe as default};
