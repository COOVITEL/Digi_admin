import{j as e,g as F}from"./turns.4589a0ea.js";import{C as D,a as _,P as L,A as O,L as k,B as q,p as B,b as Y,c as z,d as H,e as Q,f as J,g as K}from"./index.f8b4ff70.js";import{o as I}from"./options.f2ef4408.js";import{r as d}from"./index.72123234.js";import{T as U}from"./dates.27327105.js";D.register(_,L,O,k,q,B,Y,z);function V({name:t,time:a}){const i=["Caja","Crédito","Afiliación","Ahorro","Seguros","Auxilios","Estado","Otros","Obsequio"],[u,c]=d.useState([]),[n,x]=d.useState([]),[s,j]=d.useState(!0);d.useEffect(()=>{async function o(){const l=await F();c(l.data),j(!1)}o()},[s]),d.useEffect(()=>{const o=S(t,a,u);x(o)},[t,a]);const m=i.reduce((o,l)=>(o[l]=n.filter(p=>p.type2===l).length,o),{}),v=Object.values(m).reduce((o,l)=>o+l,0),g=i.map(o=>(m[o]/v*100).toFixed(2)),N={labels:i,datasets:[{data:m,backgroundColor:["rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)","rgba(72, 209, 0, 0.5)","rgba(220, 19, 0, 0.5)","rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)"],borderColor:["rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)","rgba(72, 209, 0)","rgba(220, 19, 0)","rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)"],borderWidth:2}]};function S(o,l,p){const f=new Date;let b=f.getFullYear(),T=l===0?f.getMonth()+1:f.getMonth(),C;return T==0?(b=f.getFullYear()-1,C=p.filter(h=>Number(h.date.split("-")[1])===12&&Number(h.date.split("-")[0])===b)):C=p.filter(h=>Number(h.date.split("-")[1])===T&&Number(h.date.split("-")[0])===b),l===2&&(T=f.getMonth()-1,T<0?C=p.filter(h=>Number(h.date.split("-")[1])>=12+T&&Number(h.date.split("-")[0])===b):C=p.filter(h=>Number(h.date.split("-")[1])>=T&&Number(h.date.split("-")[0])===b)),o==="all"?C:C.filter(h=>h.city===o)}return e.jsxs("div",{className:"flex flex-row w-[95%] p-10 pb-20 gap-5 items-center",children:[e.jsx("p",{className:"text-white w-52 text-center",children:"Tipos de turnos tomados por nuestros asociados, en cada una de las sucursales. Durante el mes actual, el mes pasado o durante los 3 ultimos meses."}),e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-5 rounded-lg",children:[e.jsx(H,{data:N,options:I}),e.jsx("table",{className:"text-white mt-8",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center",children:"Tipo Turno"}),i.map((o,l)=>e.jsx("th",{className:"p-2 text-center",children:o},l))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center",children:"Procentaje"}),g.map((o,l)=>e.jsxs("td",{className:"text-center",children:[o,"%"]},l))]})]})})]})]})}D.register(_,L,O,k,q,B,Y,z);function X({name:t,time:a}){const i=["Sin calificar","Calificado en Sucursal","Calificado por SMS","Calificado por llamada","No contactado"],[u,c]=d.useState(),[n,x]=d.useState([]),[s,j]=d.useState([]);d.useEffect(()=>{async function r(){const w=await F();j(w.data)}r()},[]),d.useEffect(()=>{m(s,t,a)},[t,a]);function m(r,w,P){const A=new Date;let G=A.getFullYear(),E=P===0?A.getMonth()+1:A.getMonth(),M=r.filter(y=>Number(y.date.split("-")[1])===E);E==0?(G=A.getFullYear()-1,M=r.filter(y=>Number(y.date.split("-")[1])===12&&Number(y.date.split("-")[0])===G)):M=r.filter(y=>Number(y.date.split("-")[1])===E&&Number(y.date.split("-")[0])===G),P===2&&(E=A.getMonth()-1,E<0?M=r.filter(y=>Number(y.date.split("-")[1])>=12+E):M=r.filter(y=>Number(y.date.split("-")[1])>=E)),w=="all"&&(x(M),c("Todas las Sucursales")),w!="all"&&(x(M.filter(y=>y.city===w)),c(w))}const v=n.filter(r=>r.score_time==="empty").length,g=n.filter(r=>r.score_time!="empty"&&r.state==="finished"&&r.sms_send!="send").length,N=n.filter(r=>r.score_time!="empty"&&r.state==="finished"&&r.sms_send==="send").length,S=n.filter(r=>r.score_time!="empty"&&r.state==="by_call").length,o=n.filter(r=>r.state=="not_contacted").length,l=(v/n.length*100).toFixed(2),p=(g/n.length*100).toFixed(2),f=(N/n.length*100).toFixed(2),b=(S/n.length*100).toFixed(2),T=(o/n.length*100).toFixed(2),C={labels:i,datasets:[{data:[v,g,N,S,o],backgroundColor:["rgba(230, 151, 227, 0.9)","rgba(230, 138, 82, 0.9)","rgba(242, 252, 97, 0.9)","rgba(146, 122, 197, 0.9)","rgba(116, 172, 197, 0.9)"]}]},h={plugins:{legend:{display:!0,labels:{color:"white"}}}};return e.jsxs("div",{className:"flex flex-row w-[90%] p-10 gap-5 items-center",children:[e.jsx("p",{className:"text-white w-52 text-center",children:"Conocer los canales de calificacion de nuestro servicio usados por nuestros asociados es de gran importancia. Es por esto que en esta tabla podras encontrar los diferentes pocentajes y cantidad de turnos calificados por nuestros asociados."}),e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-20 rounded-lg w-[70%]",children:[e.jsxs("h5",{className:"text-white pb-3 text-sm",children:["Estados de Calificación de Turno en ",u]}),e.jsx("div",{className:"w-[380px]",children:e.jsx(Q,{data:C,options:h})}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center text-sm",children:"Estado de Turno"}),i.map((r,w)=>e.jsx("th",{className:"p-2 text-center text-sm",children:r},w))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center text-sm",children:"Procentaje"}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[l," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[p," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[f," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[b," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[T," %"]})]})]})]})]})}D.register(_,L,O,k,q,B,Y,z);function R({name:t,time:a,typeScore:i,list:u,param:c}){const n=u,[x,s]=d.useState(n.reduce((l,p)=>(l[p]=U.filter(f=>f[c]===p).length,l),{})),[j,m]=d.useState(n.map(l=>(x[l]/U.length*100).toFixed(2))),[v,g]=d.useState("Todas las Sucursales"),[N,S]=d.useState([]);d.useEffect(()=>{async function l(){const p=await F();S(p.data)}l()},[]),d.useEffect(()=>{const l=new Date;let p=l.getFullYear(),f=a===0?l.getMonth()+1:l.getMonth(),b;f==0?(p=l.getFullYear()-1,b=N.filter(r=>Number(r.date.split("-")[1])===12&&Number(r.date.split("-")[0])===p)):b=N.filter(r=>Number(r.date.split("-")[1])===f&&Number(r.date.split("-")[0])===p),a==2&&(f=l.getMonth()-1,f<0?b=N.filter(r=>Number(r.date.split("-")[1])>=12+f):b=N.filter(r=>Number(r.date.split("-")[1])>=f)),t=="all"&&g("Todas las Sucursales"),t!="all"&&(b=b.filter(r=>r.city===t),g(t));const T=n.reduce((r,w)=>(r[w]=b.filter(P=>P[c]===w).length,r),{});s(Object.values(T));const C=Object.values(T).reduce((r,w)=>r+w,0),h=n.map(r=>(T[r]/C*100).toFixed(2));m(h)},[t,a]);const o={labels:n,datasets:[{data:x,backgroundColor:["rgb(52, 104, 192)","rgb(134, 167, 252)","rgb(170, 217, 187)","rgb(250, 239, 155)","rgba(220, 19, 0, 0.5)"],borderWidth:2}]};return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[43%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Calificación ",i,", ",v]}),e.jsx(H,{data:o,options:I}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsx("tr",{children:n.map((l,p)=>e.jsx("th",{className:"p-2 text-center",children:l},p))}),e.jsx("tr",{children:j.map((l,p)=>e.jsxs("td",{className:"p-2 text-center",children:[l,"%"]},p))})]})]})}function Z({name:t,time:a}){return e.jsxs("div",{className:"flex flex-col w-full items-center pt-5 pb-10",children:[e.jsx("h2",{className:"text-white text-2xl",children:"Calificaciones dadas por nuestros asosiados"}),e.jsx("p",{className:"text-white p-5 w-[800px] text-center",children:"Conocer el servicio brindado de nuestros asesores es de gran importancia. Pero conocer la percepcion de nuestros asociados es aun mas importante."}),e.jsx("p",{className:"text-white p-5 w-[1000px] text-center",children:"Eso por esto que acontinuación podras encontrar la percepción del servicio, atencion, tiempo de sus visitas y si nuestros asociados nos recomendarian con un amigo o conocido."}),e.jsxs("div",{className:"flex flex-wrap gap-10 m-5 justify-center items-center",children:[e.jsx(R,{name:t,time:a,typeScore:"Servicio",list:["Excelente","Bueno","Normal","Regular","Malo"],param:"score_service"}),e.jsx(R,{name:t,time:a,typeScore:"Tiempo",list:["Muy rápido","Rápido","Normal","Lento","Muy Lento"],param:"score_time"}),e.jsx(R,{name:t,time:a,typeScore:"Solicitud Atendida",list:["Si","No"],param:"score_att"}),e.jsx(R,{name:t,time:a,typeScore:"Recomendación",list:["Si","Tal vez","No"],param:"score_recommen"})]})]})}D.register(_,J,L,O,k,q,B,Y,z);function ee(t,a,i){const u=new Date;let c=u.getFullYear(),n=a===0?u.getMonth()+1:u.getMonth(),x=i.filter(s=>Number(s.date.split("-")[1])===n);return n==0?(c=u.getFullYear()-1,x=i.filter(s=>Number(s.date.split("-")[1])===12&&Number(s.date.split("-")[0])===c)):x=i.filter(s=>Number(s.date.split("-")[1])===n&&Number(s.date.split("-")[0])===c),a==2&&(n=u.getMonth()-1,n<0?x=i.filter(s=>Number(s.date.split("-")[1])>=12+n):x=i.filter(s=>Number(s.date.split("-")[1])>=n)),t==="all"?x:x.filter(s=>s.city===t)}function W(t,a,i){return t.reduce((u,c)=>{if(c[a]&&c[i]){let n=c[a].substring(0,10),x=c[i].substring(0,10);if(c.date==n&&c.date==x){let s=new Date(c[a]),m=(new Date(c[i]).getTime()-s.getTime())/6e4;u[c.date]?u[c.date]=(u[c.date]+m)/2:u[c.date]=m}}return u},{})}function $(t){return Object.values(t).reduce((a,i)=>a+i,0)/Object.values(t).length}function te(t,a,i){return{labels:t,datasets:[{data:a,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(185, 182, 25)",tension:.3},{data:i,borderColor:"rgb(238, 80, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3}]}}function se({name:t,time:a}){const[i,u]=d.useState([]),[c,n]=d.useState(),[x,s]=d.useState([]);d.useEffect(()=>{async function p(){const f=await F();s(f.data)}p()},[]),d.useEffect(()=>{const p=ee(t,a,x);u(p),n(t==="all"?"Todas las Sucursales":t)},[t,a]);const j=W(i,"arrival_time","await_time"),m=W(i,"await_time","atention_time"),v=$(j),g=$(m),N=Object.keys(j),S=Object.values(j),o=Object.values(m),l=te(N,S,o);return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[80%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Tiempo de Espera en ",c]}),e.jsx(K,{data:l,options:I}),e.jsxs("div",{className:"flex flex-row gap-16 pt-4",children:[e.jsxs("h3",{className:"text-[rgb(22,234,234)]",children:["Espera promedio:  ",v.toFixed(2)," Min"]}),e.jsxs("h3",{className:"text-[rgba(248,106,213)]",children:["Atencion promedio:  ",g.toFixed(2)," Min"]})]})]})}function ae({name:t,time:a}){return e.jsxs("div",{className:"flex flex-col items-center w-full p-10",children:[e.jsx("h2",{className:"text-white text-2xl p-5",children:"Tiempos de Atención a nuestros Asociados"}),e.jsxs("div",{className:"flex flex-row w-[100%] items-center justify-center",children:[e.jsx("p",{className:"text-white w-[300px] text-center",children:"Los tiempos de espera y atención de nuestros asociados son de gran importancia para nosotros. Es por esto que conocer los tiempos promedios de antencion a nivel general y por sucursales, nos permitiran mejorar y organizar mejor nuestro servicio."}),e.jsx("div",{className:"flex flex-col w-full items-center pt-5",children:e.jsx(se,{name:t,time:a})})]})]})}D.register(_,J,L,O,k,q,B,Y,z);function re({name:t,time:a}){const[i,u]=d.useState([]),[c,n]=d.useState([]);d.useEffect(()=>{async function m(){const v=await F();u(v.data)}m()},[]),d.useEffect(()=>{const m=le(t,a,i);n(ne(m))},[t,a]);const x=Object.keys(c),s=Object.values(c),j={labels:x,datasets:[{label:"Turnos en el Tiempo",data:s,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3}]};return e.jsxs("div",{className:"flex flex-row w-[95%] p-10 gap-5 items-center",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[95%]",children:[e.jsx("h4",{className:"text-white",children:"Cantidad de Turnos Tomados por Fecha"}),e.jsx(K,{data:j,options:I})]}),e.jsx("p",{className:"text-white w-52 text-center",children:"En esta grafica podras encontrar el numero de turnos tomados por dia a nivel general o en cada una de las sucursales. En la cual se podra determinar que dias y que fechas del mes presentamos mayor cantidad de visitas de nuestros asociados."})]})}function ne(t){return t.reduce((a,i)=>(a[i.date]?a[i.date]++:a[i.date]=1,a),{})}function le(t,a,i){const u=new Date;let c=u.getFullYear(),n=a===0?u.getMonth()+1:u.getMonth(),x;return n==0?(c=u.getFullYear()-1,x=i.filter(s=>Number(s.date.split("-")[1])===12&&Number(s.date.split("-")[0])===c)):x=i.filter(s=>Number(s.date.split("-")[1])===n&&Number(s.date.split("-")[0])===c),a===2&&(n=u.getMonth()-1,n<0?x=i.filter(s=>Number(s.date.split("-")[1])>=12+n&&Number(s.date.split("-")[0])===c):x=i.filter(s=>Number(s.date.split("-")[1])>=n&&Number(s.date.split("-")[0])===c)),t==="all"?x:x.filter(s=>s.city===t)}function xe(){const t=d.useRef(null),[a,i]=d.useState([]),[u,c]=d.useState(!0);d.useEffect(()=>{async function o(){const l=await getAllTurns();i(l.data),c(!1)}o()},[u]);const n=a.map(o=>o.city),x=[...new Set(n)],[s,j]=d.useState("all"),[m,v]=d.useState(0);d.useEffect(()=>{let o;const l=()=>{clearTimeout(o),t.current&&(t.current.style.opacity=1),o=setTimeout(()=>{t.current&&(t.current.style.opacity=0)},500)};return window.addEventListener("scroll",l,{capture:!0}),()=>{window.removeEventListener("scroll",l,{capture:!0})}},[]);function g(o,l){j(o),v(l)}function N(){t.current&&(t.current.style.opacity=1)}function S(){t.current&&(t.current.style.opacity=0)}return e.jsxs("div",{className:"flex flex-col gap-50 justify-center items-center",children:[e.jsxs("nav",{ref:t,onMouseEnter:N,onMouseLeave:S,className:"flex flex-col p-3 px-10 mt-5 fixed top-0 bg-zinc-700 rounded-lg items-center transition duration-500 opacity-0",children:[e.jsxs("ul",{className:"flex flex-row gap-10",children:[e.jsx("button",{className:s==="all"?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>g("all",m),children:"Global"},"todos"),x.map(o=>e.jsx("button",{className:s===o?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>g(o,m),children:o},o))]}),e.jsxs("ul",{className:"flex flex-row gap-10 text-zinc-400",children:[e.jsx("button",{className:m===0?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>g(s,0),children:"Mes Actual"}),e.jsx("button",{className:m===1?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>g(s,1),children:"Ultimo mes"}),e.jsx("button",{className:m===2?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>g(s,2),children:"Ultimos 3 meses"})]})]}),e.jsx("h1",{className:"text-white text-3xl mt-5 mb-5 border-b-[3px] p-5",children:"Graficos y Estadisticas Sucursales"}),e.jsx(V,{name:s,time:m}),e.jsx(re,{name:s,time:m}),e.jsx(X,{name:s,time:m}),e.jsx(Z,{name:s,time:m}),e.jsx(ae,{name:s,time:m})]})}export{xe as default};
