import{j as e,g as E}from"./turns.4589a0ea.js";import{C,a as A,P as D,A as F,L as O,B as _,p as k,b as L,c as Y,d as H,e as J,f as U,g as W}from"./index.f8b4ff70.js";import{o as q}from"./options.f2ef4408.js";import{r as u}from"./index.72123234.js";import{T as I}from"./dates.27327105.js";C.register(A,D,F,O,_,k,L,Y);function K({name:s,time:r}){u.useEffect(()=>{async function o(){const m=await E();l(m.data)}o()},[]);const n=["Caja","Crédito","Afiliación","Ahorro","Seguros","Auxilios","Estado","Otros","Obsequio"],[i,l]=u.useState([]),[a,d]=u.useState([]);u.useEffect(()=>{const o=y(s,r,i);d(o)},[s,r,i]);const t=n.reduce((o,m)=>(o[m]=a.filter(N=>N.type2===m).length,o),{}),h=Object.values(t).reduce((o,m)=>o+m,0),x=n.map(o=>(t[o]/h*100).toFixed(2)),w={labels:n,datasets:[{data:t,backgroundColor:["rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)","rgba(72, 209, 0, 0.5)","rgba(220, 19, 0, 0.5)","rgba(255, 99, 132, 0.5)","rgba(183, 46, 168, 0.5)","rgba(72, 209, 168, 0.5)"],borderColor:["rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)","rgba(72, 209, 0)","rgba(220, 19, 0)","rgba(255, 99, 132)","rgba(183, 46, 168)","rgba(72, 209, 168)"],borderWidth:2}]};function y(o,m,N){const f=new Date;let p=f.getFullYear(),g=m===0?f.getMonth()+1:f.getMonth(),j;return g==0?(p=f.getFullYear()-1,j=N.filter(b=>Number(b.date.split("-")[1])===12&&Number(b.date.split("-")[0])===p)):j=N.filter(b=>Number(b.date.split("-")[1])===g&&Number(b.date.split("-")[0])===p),m===2&&(g=f.getMonth()-1,g<0?j=N.filter(b=>Number(b.date.split("-")[1])>=12+g&&Number(b.date.split("-")[0])===p):j=N.filter(b=>Number(b.date.split("-")[1])>=g&&Number(b.date.split("-")[0])===p)),o==="all"?j:j.filter(b=>b.city===o)}return e.jsxs("div",{className:"flex flex-row w-[95%] p-10 pb-20 gap-5 items-center",children:[e.jsx("p",{className:"text-white w-52 text-center",children:"Tipos de turnos tomados por nuestros asociados, en cada una de las sucursales. Durante el mes actual, el mes pasado o durante los 3 últimos meses."}),e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-5 rounded-lg",children:[e.jsx(H,{data:w,options:q}),e.jsx("table",{className:"text-white mt-8",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center",children:"Tipo Turno"}),n.map((o,m)=>e.jsx("th",{className:"p-2 text-center",children:o},m))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center",children:"Procentaje"}),x.map((o,m)=>e.jsxs("td",{className:"text-center",children:[o,"%"]},m))]})]})})]})]})}C.register(A,D,F,O,_,k,L,Y);function Q({name:s,time:r}){const n=["Sin calificar","Calificado en Sucursal","Calificado por SMS","Calificado por llamada","No contactado"],[i,l]=u.useState(),[a,d]=u.useState([]),[t,h]=u.useState([]);u.useEffect(()=>{async function c(){const T=await E();h(T.data)}c()},[]),u.useEffect(()=>{x(t,s,r)},[s,r,t]);function x(c,T,P){const B=new Date;let G=B.getFullYear(),S=P===0?B.getMonth()+1:B.getMonth(),M=c.filter(v=>Number(v.date.split("-")[1])===S);S==0?(G=B.getFullYear()-1,M=c.filter(v=>Number(v.date.split("-")[1])===12&&Number(v.date.split("-")[0])===G)):M=c.filter(v=>Number(v.date.split("-")[1])===S&&Number(v.date.split("-")[0])===G),P===2&&(S=B.getMonth()-1,S<0?M=c.filter(v=>Number(v.date.split("-")[1])>=12+S):M=c.filter(v=>Number(v.date.split("-")[1])>=S)),T=="all"&&(d(M),l("Todas las Sucursales")),T!="all"&&(d(M.filter(v=>v.city===T)),l(T))}const w=a.filter(c=>c.score_time==="empty").length,y=a.filter(c=>c.score_time!="empty"&&c.state==="finished"&&c.sms_send!="send").length,o=a.filter(c=>c.score_time!="empty"&&c.state==="finished"&&c.sms_send==="send").length,m=a.filter(c=>c.score_time!="empty"&&c.state==="by_call").length,N=a.filter(c=>c.state=="not_contacted").length,f=(w/a.length*100).toFixed(2),p=(y/a.length*100).toFixed(2),g=(o/a.length*100).toFixed(2),j=(m/a.length*100).toFixed(2),b=(N/a.length*100).toFixed(2),R={labels:n,datasets:[{data:[w,y,o,m,N],backgroundColor:["rgba(230, 151, 227, 0.9)","rgba(230, 138, 82, 0.9)","rgba(242, 252, 97, 0.9)","rgba(146, 122, 197, 0.9)","rgba(116, 172, 197, 0.9)"]}]},$={plugins:{legend:{display:!0,labels:{color:"white"}}}};return e.jsxs("div",{className:"flex flex-row w-[90%] p-10 gap-5 items-center",children:[e.jsx("p",{className:"text-white w-52 text-center",children:"Conocer los canales de calificación de nuestro servicio usados por nuestros asociados es de gran importancia. Es por esto que en esta tabla podrás encontrar los diferentes porcentajes y cantidad de turnos calificados por nuestros asociados."}),e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 mt-20 rounded-lg w-[70%]",children:[e.jsxs("h5",{className:"text-white pb-3 text-sm",children:["Estados de Calificación de Turno en ",i]}),e.jsx("div",{className:"w-[380px]",children:e.jsx(J,{data:R,options:$})}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center text-sm",children:"Estado de Turno"}),n.map((c,T)=>e.jsx("th",{className:"p-2 text-center text-sm",children:c},T))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 text-center text-sm",children:"Procentaje"}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[f," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[p," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[g," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[j," %"]}),e.jsxs("td",{className:"p-2 text-center text-sm",children:[b," %"]})]})]})]})]})}C.register(A,D,F,O,_,k,L,Y);function z({name:s,time:r,typeScore:n,list:i,param:l}){const a=i,[d,t]=u.useState(a.reduce((f,p)=>(f[p]=I.filter(g=>g[l]===p).length,f),{})),[h,x]=u.useState(a.map(f=>(d[f]/I.length*100).toFixed(2))),[w,y]=u.useState("Todas las Sucursales"),[o,m]=u.useState([]);u.useEffect(()=>{async function f(){const p=await E();m(p.data)}f()},[]),u.useEffect(()=>{const f=new Date;let p=f.getFullYear(),g=r===0?f.getMonth()+1:f.getMonth(),j;g==0?(p=f.getFullYear()-1,j=o.filter(c=>Number(c.date.split("-")[1])===12&&Number(c.date.split("-")[0])===p)):j=o.filter(c=>Number(c.date.split("-")[1])===g&&Number(c.date.split("-")[0])===p),r==2&&(g=f.getMonth()-1,g<0?j=o.filter(c=>Number(c.date.split("-")[1])>=12+g):j=o.filter(c=>Number(c.date.split("-")[1])>=g)),s=="all"&&y("Todas las Sucursales"),s!="all"&&(j=j.filter(c=>c.city===s),y(s));const b=a.reduce((c,T)=>(c[T]=j.filter(P=>P[l]===T).length,c),{});t(Object.values(b));const R=Object.values(b).reduce((c,T)=>c+T,0),$=a.map(c=>(b[c]/R*100).toFixed(2));x($)},[s,r,o]);const N={labels:a,datasets:[{data:d,backgroundColor:["rgb(52, 104, 192)","rgb(134, 167, 252)","rgb(170, 217, 187)","rgb(250, 239, 155)","rgba(220, 19, 0, 0.5)"],borderWidth:2}]};return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[43%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Calificación ",n,", ",w]}),e.jsx(H,{data:N,options:q}),e.jsxs("table",{className:"text-white mt-8",children:[e.jsx("tr",{children:a.map((f,p)=>e.jsx("th",{className:"p-2 text-center",children:f},p))}),e.jsx("tr",{children:h.map((f,p)=>e.jsxs("td",{className:"p-2 text-center",children:[f,"%"]},p))})]})]})}function V({name:s,time:r}){return e.jsxs("div",{className:"flex flex-col w-full items-center pt-5 pb-10",children:[e.jsx("h2",{className:"text-white text-2xl",children:"Calificaciones dadas por nuestros asociados"}),e.jsx("p",{className:"text-white p-5 w-[800px] text-center",children:"Conocer el servicio brindado de nuestros asesores es de gran importancia. Pero conocer la percepcion de nuestros asociados es aún más importante."}),e.jsx("p",{className:"text-white p-5 w-[1000px] text-center",children:"Eso por esto que a continuación podrás encontrar la percepción del servicio, atención, tiempo de sus visitas y si nuestros asociados nos recomendarían con un amigo o conocido."}),e.jsxs("div",{className:"flex flex-wrap gap-10 m-5 justify-center items-center",children:[e.jsx(z,{name:s,time:r,typeScore:"Servicio",list:["Excelente","Bueno","Normal","Regular","Malo"],param:"score_service"}),e.jsx(z,{name:s,time:r,typeScore:"Tiempo",list:["Muy rápido","Rápido","Normal","Lento","Muy Lento"],param:"score_time"}),e.jsx(z,{name:s,time:r,typeScore:"Solicitud Atendida",list:["Si","No"],param:"score_att"}),e.jsx(z,{name:s,time:r,typeScore:"Recomendación",list:["Si","Tal vez","No"],param:"score_recommen"})]})]})}C.register(A,U,D,F,O,_,k,L,Y);function X(s,r,n){const i=new Date;let l=i.getFullYear(),a=r===0?i.getMonth()+1:i.getMonth(),d=n.filter(t=>Number(t.date.split("-")[1])===a);return a==0?(l=i.getFullYear()-1,d=n.filter(t=>Number(t.date.split("-")[1])===12&&Number(t.date.split("-")[0])===l)):d=n.filter(t=>Number(t.date.split("-")[1])===a&&Number(t.date.split("-")[0])===l),r==2&&(a=i.getMonth()-1,a<0?d=n.filter(t=>Number(t.date.split("-")[1])>=12+a):d=n.filter(t=>Number(t.date.split("-")[1])>=a)),s==="all"?d:d.filter(t=>t.city===s)}function Z(s,r,n){return s.reduce((i,l)=>{if(l[r]&&l[n]){let a=l[r].substring(0,10),d=l[n].substring(0,10);if(l.date==a&&l.date==d){let t=new Date(l[r]),x=(new Date(l[n]).getTime()-t.getTime())/6e4;i[l.date]?i[l.date]=(i[l.date]+x)/2:i[l.date]=x}}return i},{})}function ee(s){return Object.values(s).reduce((r,n)=>r+n,0)/Object.values(s).length}function te(s,r){return{labels:s,datasets:[{data:r,borderColor:"rgb(238, 80, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3,label:"Tiempo de Atención Promedio: "}]}}function se({name:s,time:r}){const[n,i]=u.useState([]),[l,a]=u.useState([]),[d,t]=u.useState();u.useEffect(()=>{async function m(){const N=await E();i(N.data)}m()},[]),u.useEffect(()=>{const m=X(s,r,n);a(m),t(s==="all"?"Todas las Sucursales":s)},[s,r,n]);const h=Z(l,"await_time","atention_time"),x=ee(h),w=Object.keys(h),y=Object.values(h),o=te(w,y);return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[80%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Tiempo de Atencion en ",d]}),e.jsx(W,{data:o,options:q}),e.jsx("div",{className:"flex flex-row gap-16 pt-4",children:e.jsxs("h3",{className:"text-[rgba(248,106,213)]",children:["Atencion promedio:  ",x.toFixed(2)," Minutos"]})})]})}C.register(A,U,D,F,O,_,k,L,Y);function ae(s,r,n){const i=new Date;let l=i.getFullYear(),a=r===0?i.getMonth()+1:i.getMonth(),d=n.filter(t=>Number(t.date.split("-")[1])===a);return a==0?(l=i.getFullYear()-1,d=n.filter(t=>Number(t.date.split("-")[1])===12&&Number(t.date.split("-")[0])===l)):d=n.filter(t=>Number(t.date.split("-")[1])===a&&Number(t.date.split("-")[0])===l),r==2&&(a=i.getMonth()-1,a<0?d=n.filter(t=>Number(t.date.split("-")[1])>=12+a):d=n.filter(t=>Number(t.date.split("-")[1])>=a)),s==="all"?d:d.filter(t=>t.city===s)}function re(s,r,n){return s.reduce((i,l)=>{if(l[r]&&l[n]){let a=l[r].substring(0,10),d=l[n].substring(0,10);if(l.date==a&&l.date==d){let t=new Date(l[r]),x=(new Date(l[n]).getTime()-t.getTime())/6e4;i[l.date]?i[l.date]=(i[l.date]+x)/2:i[l.date]=x}}return i},{})}function le(s){return Object.values(s).reduce((r,n)=>r+n,0)/Object.values(s).length}function ne(s,r){return{labels:s,datasets:[{data:r,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(185, 182, 25)",tension:.3,label:"Tiempo de Espera Promedio: "}]}}function ie({name:s,time:r}){const[n,i]=u.useState([]),[l,a]=u.useState([]),[d,t]=u.useState();u.useEffect(()=>{async function m(){const N=await E();i(N.data)}m()},[]),u.useEffect(()=>{const m=ae(s,r,n);a(m),t(s==="all"?"Todas las Sucursales":s)},[s,r,n]);const h=re(l,"arrival_time","await_time"),x=le(h),w=Object.keys(h),y=Object.values(h),o=ne(w,y);return e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[80%] h-auto",children:[e.jsxs("h4",{className:"text-white",children:["Tiempo de Espera en ",d]}),e.jsx(W,{data:o,options:q}),e.jsx("div",{className:"flex flex-row gap-16 pt-4",children:e.jsxs("h3",{className:"text-[rgb(22,234,234)]",children:["Espera promedio:  ",x.toFixed(2)," Minutos"]})})]})}function oe({name:s,time:r}){return e.jsxs("div",{className:"flex flex-col items-center w-full p-10 pb-24",children:[e.jsx("h2",{className:"text-white text-2xl p-5",children:"Tiempos de Espera y Atención a nuestros Asociados"}),e.jsxs("div",{className:"flex flex-row w-[100%] items-center justify-center",children:[e.jsx("p",{className:"text-white w-[300px] text-center",children:"Tiempos de espera promedio de nuestros asociados para ser atendidos por nuestros asesores. Los tiempos pueden ser obtenidos por día, por mes actual, último mes o ultimos 3 meses, y de forma global o por cada de nuestras sucursales."}),e.jsx("div",{className:"flex flex-col w-full items-center pt-5",children:e.jsx(ie,{name:s,time:r})})]}),e.jsxs("div",{className:"flex flex-row-reverse w-[100%] items-center justify-center m-10",children:[e.jsx("p",{className:"text-white w-[300px] text-center",children:"El tiempo de atención es de gran importancia, ya que allí medimos el servicio brindado hacia nuestros asesores. Acá podrás observar un tiempo promedio por día, mes actual, último mes o últmos 3 meses, de forma global o por cada una de nuestras sucursales."}),e.jsx("div",{className:"flex flex-col w-full items-center pt-5",children:e.jsx(se,{name:s,time:r})})]})]})}C.register(A,U,D,F,O,_,k,L,Y);function ce({name:s,time:r}){const[n,i]=u.useState([]),[l,a]=u.useState([]);u.useEffect(()=>{async function x(){const w=await E();i(w.data)}x()},[]),u.useEffect(()=>{const x=ue(s,r,n);a(de(x))},[s,r,n]);const d=Object.keys(l),t=Object.values(l),h={labels:d,datasets:[{label:"Turnos en el Tiempo",data:t,borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgba(75, 132, 255)",tension:.3}]};return e.jsxs("div",{className:"flex flex-row w-[95%] p-10 gap-5 items-center",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center border-2 p-5 rounded-lg w-[95%]",children:[e.jsx("h4",{className:"text-white",children:"Cantidad de Turnos Tomados por Fecha"}),e.jsx(W,{data:h,options:q})]}),e.jsx("p",{className:"text-white w-52 text-center",children:"En esta grafica podrás encontrar el número de turnos tomados por día a nivel general o en cada una de las sucursales. En la cual se podrá determinar que días y que fechas del mes presentamos mayor cantidad de visitas de nuestros asociados."})]})}function de(s){return s.reduce((r,n)=>(r[n.date]?r[n.date]++:r[n.date]=1,r),{})}function ue(s,r,n){const i=new Date;let l=i.getFullYear(),a=r===0?i.getMonth()+1:i.getMonth(),d;return a==0?(l=i.getFullYear()-1,d=n.filter(t=>Number(t.date.split("-")[1])===12&&Number(t.date.split("-")[0])===l)):d=n.filter(t=>Number(t.date.split("-")[1])===a&&Number(t.date.split("-")[0])===l),r===2&&(a=i.getMonth()-1,a<0?d=n.filter(t=>Number(t.date.split("-")[1])>=12+a&&Number(t.date.split("-")[0])===l):d=n.filter(t=>Number(t.date.split("-")[1])>=a&&Number(t.date.split("-")[0])===l)),s==="all"?d:d.filter(t=>t.city===s)}function be(){const s=u.useRef(null),[r,n]=u.useState([]),i=r.map(o=>o.city),l=[...new Set(i)],[a,d]=u.useState("all"),[t,h]=u.useState(0);u.useEffect(()=>{async function o(){const m=await E();n(m.data)}o()},[l]),u.useEffect(()=>{let o;const m=()=>{clearTimeout(o),s.current&&(s.current.style.opacity=1),o=setTimeout(()=>{s.current&&(s.current.style.opacity=0)},500)};return window.addEventListener("scroll",m,{capture:!0}),()=>{window.removeEventListener("scroll",m,{capture:!0})}},[]);function x(o,m){d(o),h(m)}function w(){s.current&&(s.current.style.opacity=1)}function y(){s.current&&(s.current.style.opacity=0)}return e.jsxs("div",{className:"flex flex-col gap-50 justify-center items-center",children:[e.jsxs("nav",{ref:s,onMouseEnter:w,onMouseLeave:y,className:"flex flex-col p-3 px-10 mt-5 fixed top-0 bg-zinc-700 rounded-lg items-center transition duration-500 opacity-0",children:[e.jsxs("ul",{className:"flex flex-row gap-10",children:[e.jsx("button",{className:a==="all"?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>x("all",t),children:"Global"},"todos"),l.map(o=>e.jsx("button",{className:a===o?"text-white text-xl":"text-zinc-400 hover:scale-110  hover:text-white",onClick:()=>x(o,t),children:o},o))]}),e.jsxs("ul",{className:"flex flex-row gap-10 text-zinc-400",children:[e.jsx("button",{className:t===0?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>x(a,0),children:"Mes Actual"}),e.jsx("button",{className:t===1?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>x(a,1),children:"Ultimo mes"}),e.jsx("button",{className:t===2?"text-white text-xl":"text-zinc-400 hover:scale-110 hover:text-white",onClick:()=>x(a,2),children:"Ultimos 3 meses"})]})]}),e.jsx("h1",{className:"text-white text-3xl mt-5 mb-5 border-b-[3px] p-5",children:"Gráficos y Estadísticas Sucursales"}),e.jsx(K,{name:a,time:t}),e.jsx(ce,{name:a,time:t}),e.jsx(Q,{name:a,time:t}),e.jsx(oe,{name:a,time:t}),e.jsx(V,{name:a,time:t})]})}export{be as default};
